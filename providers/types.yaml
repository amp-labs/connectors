# ==================================
# DO NOT EDIT THIS FILE unless you are sure of the dependencies as this
# schema is being referenced in other specs.
# ==================================

# This file contains the schema for the provider catalog and helps generate
# the Go types for the schema. The schema is used to create a provider catalog.

openapi: 3.0.0

info:
  version: 1.0.0
  title: Provider catalog

components:
  schemas:
    AuthType:
      type: string
      enum: [oauth2, api_key, basic, none]
      x-oapi-codegen-extra-tags:
        validate: required

    Support:
      type: object
      x-oapi-codegen-extra-tags:
        validate: required
      required:
        - bulkWrite
        - proxy
        - read
        - subscribe
        - write
      properties:
        bulkWrite:
          $ref: '#/components/schemas/BulkWriteSupport'
        proxy:
          type: boolean
        read:
          type: boolean
        subscribe:
          type: boolean
        write:
          type: boolean
    BulkWriteSupport:
      type: object
      x-oapi-codegen-extra-tags:
        validate: required
      required:
        - insert
        - update
        - upsert
        - delete
      properties:
        insert:
          type: boolean
        update:
          type: boolean
        upsert:
          type: boolean
        delete:
          type: boolean
    TokenMetadataFields:
      type: object
      properties:
        workspaceRefField:
          type: string
          example: account-id
          x-go-type-skip-optional-pointer: true
        consumerRefField:
          type: string
          example: user-id
          x-go-type-skip-optional-pointer: true
        scopesField:
          type: string
          example: scopes
          x-go-type-skip-optional-pointer: true

    OauthOpts:
      type: object
      required:
          - grantType
          - tokenURL
          - explicitScopesRequired
          - explicitWorkspaceRequired
          - tokenMetadataFields
      properties:
        grantType:
          type: string
          enum: [authorizationCode, clientCredentials, PKCE]
        authURL:
          type: string
          example: https://login.salesforce.com/services/oauth2/authorize
          x-go-type-skip-optional-pointer: true
        tokenURL:
          type: string
          example: https://login.salesforce.com/services/oauth2/token
          x-oapi-codegen-extra-tags:
            validate: required
        explicitScopesRequired:
          type: boolean
          example: true
        explicitWorkspaceRequired:
          type: boolean
          example: true
        audience:
          type: string
          example: https://api.mparticle.com
          x-go-type-skip-optional-pointer: true
        tokenMetadataFields:
          $ref: '#/components/schemas/TokenMetadataFields'

    ApiKeyOpts:
      type: object
      required:
        - headerName
      properties:
        headerName:
          type: string
          example: X-Api-Key
          x-oapi-codegen-extra-tags:
            validate: required
        valuePrefix:
          type: string
          example: "Bearer "
          x-go-type-skip-optional-pointer: true
        docsURL:
          type: string
          description: URL with more information about how to get or use an API key.
          example: https://docs.example.com/api-key
          x-go-type-skip-optional-pointer: true

    ProviderOpts:
        type: object
        additionalProperties:
          type: string

    Provider:
      type: string
      example: salesforce

    ProviderInfo:
      type: object
      required:
        - name
        - baseURL
        - authType
        - support
        - providerOpts
      properties:
        name:
          # If you're maintaining catalog.go, the name field will be auto-set for you,
          # so you don't need to worry about it. Add it for completeness if you want.
          type: string
        authType:
          $ref: '#/components/schemas/AuthType'
        baseURL:
          type: string
          x-oapi-codegen-extra-tags:
            validate: required
        oauthOpts:
          $ref: '#/components/schemas/OauthOpts'
        apiKeyOpts:
          $ref: '#/components/schemas/ApiKeyOpts'
        support:
          $ref: '#/components/schemas/Support'
        providerOpts:
          $ref: '#/components/schemas/ProviderOpts'
        displayName:
          type: string
          example: Zendesk Chat
          description: The display name of the provider, if omitted, defaults to provider name.
          x-go-type-skip-optional-pointer: true
        postAuthInfoNeeded:
          type: boolean
          example: true
          description: If true, we require additional information after auth to start making requests.
          x-go-type-skip-optional-pointer: true

    CatalogType:
      type: object
      additionalProperties:
        $ref: '#/components/schemas/ProviderInfo'
